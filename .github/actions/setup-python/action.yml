name: Setup Python & uv
description: Setup Python and uv package manager with caching

inputs:
  python-version:
    description: Python version to use
    required: false
    default: "3.11"
  install-deps:
    description: Whether to install dependencies
    required: false
    default: "true"
  dev-deps:
    description: Whether to install dev dependencies (only if install-deps is true)
    required: false
    default: "true"
  frozen:
    description: Whether to use --frozen flag (only if install-deps is true)
    required: false
    default: "false"

runs:
  using: composite
  steps:
    - name: Install uv
      uses: astral-sh/setup-uv@v4
      with:
        enable-cache: true
        cache-dependency-glob: "uv.lock"

    - name: Setup Python
      uses: actions/setup-python@v5
      with:
        python-version: ${{ inputs.python-version }}

    - name: Install dependencies
      if: inputs.install-deps == 'true'
      shell: bash
      run: |
        FLAGS=""
        if [ "${{ inputs.dev-deps }}" = "true" ]; then
          FLAGS="$FLAGS --dev"
        fi
        if [ "${{ inputs.frozen }}" = "true" ]; then
          FLAGS="$FLAGS --frozen"
        fi
        uv sync $FLAGS
